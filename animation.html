<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Responsive Animation</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Open+Sans:wght@300;400&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .section {
            font-family: 'Poppins', sans-serif;
            overflow-x: hidden;
        }

        .content-area p {
            font-family: 'Open Sans', sans-serif;
            color: #999;
            padding-top: 10px;
        }

        .containers {
            max-width: 1200px;
            margin: 0 auto;
        }

        .rounded-custom {
            border-radius: 6px !important;
            padding: 12px 40px;
        }

        .btn-black {
            background-color: black;
            color: white;
            /* Text color for the solid button */
        }

        .btn-black:hover {
            border-color: black;
            color: black;
        }

        .btn-outline-black:hover {
            background-color: black;
            color: #fff;
        }

        .btn-outline-black {
            border-color: black;
            color: black;
        }

        .section {
            position: relative;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .floating-img {
            width: 100%;
            height: auto;
            max-width: 250px;
            display: block;
            position: absolute;
            top: 0;
            margin: 0 auto;
            opacity: 1;
            animation: floatUpDown 2s ease-in-out infinite;

        }



        /* Floating keyframes animation */
        @keyframes floatUpDown {
            0% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-15px);
            }

            100% {
                transform: translateY(0px);
            }
        }


        @media (max-width: 768px) {
            .floating-img {
                max-width: 300px;
                display: none;
            }


            .content-area p {
                font-size: 0.9rem;
            }

            .content-area h1 {
                font-weight: 600;
                margin-bottom: 20px;
                font-size: 2.5rem !important;
                line-height: 3.4rem !important;
                overflow: hidden;
            }

            .section {
                padding: 0px 20px;
            }

            .content-area p {

                padding-top: 0px;
            }

            .rounded-custom {
                border-radius: 6px !important;
                padding: 12px 30px;
                font-size: 14px;
            }
        }


        .content-area h1 {
            font-weight: 600;
            margin-bottom: 20px;
            font-size: 3.5rem;
            line-height: 4.4rem;
            overflow: hidden;
        }

        .button-area {
            padding-top: 20px;
        }

        .rounded-custom i {
            margin-right: 5px;
        }
    </style>
    <!-- Include GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
</head>

<body>
    <section class="one"></section>
    <div id="wrapper">
        <section class="section" id="section1">
            <div class="containers">
                <div class="row">
                    <div class="col-12 col-md-6 d-flex align-items-center justify-content-center">
                        <div class="content-area">
                            <h1 id="heading1">Digital Marketing</h1>
                            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Doloremque quam expedita, quae,
                                repellat dolorum fugiat quaerat harum fugit maiores voluptate nobis esse eveniet saepe.
                                Ipsa
                                ut placeat, quaerat voluptas labore doloremque tempore odio? Non quos quis debitis
                                libero
                                commodi perspiciatis veniam rerum beatae, mollitia nobis perferendis assumenda, ut
                                ratione
                                cum repudiandae et, incidunt eveniet dolorum quo? Ullam beatae sint nisi?</p>
                            <div class="button-area">
                                <a href="#" class="btn btn-black rounded-custom me-2">
                                    <i class="fab fa-apple"></i> Get App
                                </a>
                                <a href="#" class="btn btn-outline-black rounded-custom">
                                    <i class="fab fa-apple"></i> Get App
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-md-6 image-div" id="imageDiv1"></div>
                </div>
            </div>
        </section>

        <section class="section" id="section1">
            <div class="containers">
                <div class="row">
                    <div class="col-12 col-md-6 image-div" id="imageDiv1"></div>
                    <div class="col-12 col-md-6 d-flex align-items-center justify-content-center">
                        <div class="content-area">
                            <h1 id="heading1">Digital Marketing</h1>
                            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Doloremque quam expedita, quae,
                                repellat dolorum fugiat quaerat harum fugit maiores voluptate nobis esse eveniet saepe.
                                Ipsa
                                ut placeat, quaerat voluptas labore doloremque tempore odio? Non quos quis debitis
                                libero
                                commodi perspiciatis veniam rerum beatae, mollitia nobis perferendis assumenda, ut
                                ratione
                                cum repudiandae et, incidunt eveniet dolorum quo? Ullam beatae sint nisi?</p>
                            <div class="button-area">
                                <a href="#" class="btn btn-black rounded-custom me-2">
                                    <i class="fab fa-apple"></i> Get App
                                </a>
                                <a href="#" class="btn btn-outline-black rounded-custom">
                                    <i class="fab fa-apple"></i> Get App
                                </a>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <section class="section" id="section1">
            <div class="containers">
                <div class="row">
                    <div class="col-12 col-md-6 d-flex align-items-center justify-content-center">
                        <div class="content-area">
                            <h1 id="heading1">Digital Marketing</h1>
                            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Doloremque quam expedita, quae,
                                repellat dolorum fugiat quaerat harum fugit maiores voluptate nobis esse eveniet saepe.
                                Ipsa
                                ut placeat, quaerat voluptas labore doloremque tempore odio? Non quos quis debitis
                                libero
                                commodi perspiciatis veniam rerum beatae, mollitia nobis perferendis assumenda, ut
                                ratione
                                cum repudiandae et, incidunt eveniet dolorum quo? Ullam beatae sint nisi?</p>
                            <div class="button-area">
                                <a href="#" class="btn btn-black rounded-custom me-2">
                                    <i class="fab fa-apple"></i> Get App
                                </a>
                                <a href="#" class="btn btn-outline-black rounded-custom">
                                    <i class="fab fa-apple"></i> Get App
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-md-6 image-div" id="imageDiv1"></div>
                </div>
            </div>
        </section>
    </div>



    <script>
        const sections = document.querySelectorAll('.section');
        const floatingImage = document.createElement('img');
        floatingImage.src = "iphone.avif";
        floatingImage.classList.add('floating-img');
        document.body.appendChild(floatingImage);

        const imageSources = [
            "iphone.avif", // Section 1
            "iphone2.avif", // Section 2
            "iphoneyellow.png"
        ];

        let currentImageIndex = 0;

        // Change image when entering the section
        function changeImage(index) {
            if (currentImageIndex !== index) {
                currentImageIndex = index;

                gsap.to(floatingImage, {
                    opacity: 0,
                    duration: 0.5,
                    onComplete: () => {
                        floatingImage.src = imageSources[index];

                        // Adjust the width for the specific image in Section 2
                        if (index === 1) {
                            gsap.set(floatingImage, { width: "200px" }); // Set custom width for Section 2
                        } else {
                            gsap.set(floatingImage, { width: "250px" });     // Default width for other sections
                        }

                        gsap.to(floatingImage, { opacity: 1, duration: 0.5 });
                    }
                });
            }
        }


        // // Function for split text animation
        // function splitTextAnimation(headingElement) {
        //     const text = headingElement.innerText.split('');
        //     headingElement.innerHTML = '';

        //     text.forEach(char => {
        //         const span = document.createElement('span');
        //         span.innerText = char;
        //         span.style.display = 'inline-block';
        //         headingElement.appendChild(span);
        //     });

        //     const spans = headingElement.querySelectorAll('span');

        //     gsap.from(spans, {
        //         opacity: 0,
        //         y: 50,
        //         stagger: 0.1,
        //         duration: 0.5,
        //         ease: "back.out(1.7)",
        //     });
        // }

        // Intersection Observer to detect when sections come into view
        const observerOptions = {
            root: null, // Observe based on viewport
            threshold: 0.3 // Trigger when 30% of the section is visible
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const sectionIndex = Array.from(sections).indexOf(entry.target);
                    changeImage(sectionIndex);
                    splitTextAnimation(entry.target.querySelector('h1'));
                }
            });
        }, observerOptions);

        sections.forEach(section => {
            observer.observe(section);
        });

        //    GSAP animation function for parallax movement, active only within the #wrapper section
        function moveImageAccordingToScroll() {
            const scrollPosition = window.scrollY;
            const windowHeight = window.innerHeight;
            const wrapper = document.getElementById('wrapper');
            const wrapperRect = wrapper.getBoundingClientRect();

            // Check if the scroll position is within the bounds of the #wrapper
            if (wrapperRect.top < windowHeight && wrapperRect.bottom > 0) {
                const totalHeight = wrapper.scrollHeight - windowHeight;
                const sectionHeight = totalHeight / (sections.length - 1);

                const currentSectionIndex = Math.floor(scrollPosition / sectionHeight);
                const nextSectionIndex = Math.min(currentSectionIndex + 1, sections.length - 1);

                const startSection = sections[currentSectionIndex];
                const endSection = sections[nextSectionIndex];

                const startRect = startSection.querySelector('.image-div').getBoundingClientRect();
                const endRect = endSection.querySelector('.image-div').getBoundingClientRect();

                let startY, startX, endY, endX;

                // Calculate the vertical middle position for the text column
                const textColumnHeight = startSection.querySelector('.content-area').getBoundingClientRect().height;
                const middlePosition = (textColumnHeight / 2) + startRect.top + window.scrollY - (floatingImage.offsetHeight / 2);

                // Special case for the first section to be 100px from the top
                if (currentSectionIndex === 0) {
                    startY = 100; // 100px from the top for the first section
                    startX = startRect.left + window.scrollX + (startRect.width / 2) - (floatingImage.offsetWidth / 2);
                } else {
                    startY = middlePosition;
                    startX = startRect.left + window.scrollX + (startRect.width / 2) - (floatingImage.offsetWidth / 2);
                }

                endY = (endRect.top + window.scrollY) + (endRect.height / 2) - (floatingImage.offsetHeight / 2);
                endX = endRect.left + window.scrollX + (endRect.width / 2) - (floatingImage.offsetWidth / 2);

                const progress = (scrollPosition % sectionHeight) / sectionHeight;

                const currentY = startY + (endY - startY) * progress;
                const currentX = startX + (endX - startX) * progress;

                gsap.to(floatingImage, {
                    top: currentY,
                    left: currentX,
                    duration: 0.1,
                    ease: "linear"
                });
            } else {
                // Hide or reset floating image position if out of bounds
                gsap.to(floatingImage, {
                    opacity: 0,
                    duration: 0.3,
                });
            }
        }

        window.addEventListener('scroll', moveImageAccordingToScroll);
        moveImageAccordingToScroll();



    </script>

    <!-- Bootstrap 5 JS (Optional if you need Bootstrap JS functionalities) -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js"></script>
</body>

</html>